#!/bin/bash
set -euo pipefail

echo "Running pre-commit checks..."

fail() { echo "$1"; exit 1; }

(cd backend && cargo fmt --check) || fail "Backend formatting failed!"
(cd backend && cargo clippy -- -D warnings) || fail "Backend clippy failed!"
(cd frontend && npm run check) || fail "Frontend type checking failed!"
(cd frontend && npm run lint) || fail "Frontend lint failed!"
(cd backend && cargo test) || fail "Backend tests failed!"
(cd frontend && npm test) || fail "Frontend tests failed!"

echo "All checks passed!"
